<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Apple Weather Clone</title>
  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: linear-gradient(to bottom, #0f2027, #203a43, #2c5364);
      color: white;
      display: flex;
      justify-content: center;
    }
    .app {
      max-width: 600px;
      width: 100%;
      padding: 20px;
    }
    .current {
      text-align: center;
      margin-bottom: 30px;
    }
    .current h1 {
      font-size: 5rem;
      margin: 0;
    }
    .current h2 {
      font-size: 1.5rem;
      margin: 5px 0;
      font-weight: 400;
    }
    .card {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      padding: 15px;
      margin-bottom: 20px;
      backdrop-filter: blur(10px);
    }
    .hourly-scroll {
      display: flex;
      overflow-x: auto;
      gap: 15px;
    }
    .hour {
      text-align: center;
      min-width: 60px;
    }
    .day {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid rgba(255,255,255,0.2);
    }
    .details {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }
    .detail-card {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 15px;
      text-align: center;
    }
    .detail-card h3 {
      font-size: 0.9rem;
      font-weight: 400;
      margin: 0 0 5px;
    }
    .detail-card p {
      font-size: 1.2rem;
      margin: 0;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="current" id="currentWeather">Loading...</div>

    <div class="card">
      <h3>Hourly Forecast</h3>
      <div class="hourly-scroll" id="hourlyForecast"></div>
    </div>

    <div class="card">
      <h3>10-Day Forecast</h3>
      <div id="dailyForecast"></div>
    </div>

    <div class="details" id="details"></div>
  </div>

  <script>
    async function fetchWeather(lat, lon, locationName="Your Location") {
      const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&hourly=temperature_2m,apparent_temperature,precipitation_probability,relative_humidity_2m,windspeed_10m&daily=temperature_2m_max,temperature_2m_min,sunrise,sunset,uv_index_max,precipitation_sum,moon_phase&timezone=auto`;
      
      const airUrl = `https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${lat}&longitude=${lon}&hourly=us_aqi&timezone=auto`;

      const [weatherRes, airRes] = await Promise.all([fetch(url), fetch(airUrl)]);
      const weather = await weatherRes.json();
      const air = await airRes.json();

      displayWeather(weather, air, locationName);
    }

    function displayWeather(data, air, locationName) {
      const current = data.current_weather;
      const nowTemp = Math.round(current.temperature);
      const feelsLike = Math.round(data.hourly.apparent_temperature[0]);
      const humidity = data.hourly.relative_humidity_2m[0];
      const wind = Math.round(data.hourly.windspeed_10m[0]);
      const uv = data.daily.uv_index_max[0];
      const sunrise = new Date(data.daily.sunrise[0]).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
      const sunset = new Date(data.daily.sunset[0]).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
      const moon = data.daily.moon_phase[0].toFixed(2);
      const aqi = air.hourly.us_aqi[0];

      // Current
      document.getElementById("currentWeather").innerHTML = `
        <h2>${locationName}</h2>
        <h1>${nowTemp}°</h1>
        <h2>Feels like ${feelsLike}°</h2>
        <p>Humidity ${humidity}% • Wind ${wind} km/h</p>
      `;

      // Hourly
      const hourlyEl = document.getElementById("hourlyForecast");
      hourlyEl.innerHTML = "";
      for (let i = 0; i < 12; i++) {
        const time = new Date(data.hourly.time[i]).getHours();
        const temp = Math.round(data.hourly.temperature_2m[i]);
        const pop = data.hourly.precipitation_probability[i];
        hourlyEl.innerHTML += `
          <div class="hour">
            <div>${time}:00</div>
            <div>${temp}°</div>
            <div>${pop}%</div>
          </div>
        `;
      }

      // Daily
      const dailyEl = document.getElementById("dailyForecast");
      dailyEl.innerHTML = "";
      for (let i = 0; i < 10; i++) {
        const date = new Date(data.daily.time[i]);
        const day = date.toLocaleDateString("en-US", { weekday: "short" });
        const min = Math.round(data.daily.temperature_2m_min[i]);
        const max = Math.round(data.daily.temperature_2m_max[i]);
        const pop = data.daily.precipitation_sum[i];
        dailyEl.innerHTML += `
          <div class="day">
            <div>${day}</div>
            <div>${max}° / ${min}°</div>
            <div>${pop}mm</div>
          </div>
        `;
      }

      // Details
      document.getElementById("details").innerHTML = `
        <div class="detail-card"><h3>UV Index</h3><p>${uv}</p></div>
        <div class="detail-card"><h3>Air Quality</h3><p>${aqi}</p></div>
        <div class="detail-card"><h3>Sunrise</h3><p>${sunrise}</p></div>
        <div class="detail-card"><h3>Sunset</h3><p>${sunset}</p></div>
        <div class="detail-card"><h3>Wind</h3><p>${wind} km/h</p></div>
        <div class="detail-card"><h3>Humidity</h3><p>${humidity}%</p></div>
        <div class="detail-card"><h3>Moon</h3><p>${moon}</p></div>
      `;
    }

    // Detect location
    navigator.geolocation.getCurrentPosition(
      (pos) => fetchWeather(pos.coords.latitude, pos.coords.longitude, "Your Location"),
      () => fetchWeather(40.7128, -74.0060, "New York") // fallback
    );
  </script>
</body>
</html>
